(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/addProduct/addProduct"],{3508:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},n=[];r.d(e,"a",function(){return a}),r.d(e,"b",function(){return n})},9647:function(t,e,r){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(r("a34a"));function i(t){return t&&t.__esModule?t:{default:t}}function u(t,e,r,a,n,i,u){try{var o=t[i](u),s=o.value}catch(c){return void r(c)}o.done?e(s):Promise.resolve(s).then(a,n)}function o(t){return function(){var e=this,r=arguments;return new Promise(function(a,n){var i=t.apply(e,r);function o(t){u(i,a,n,o,s,"next",t)}function s(t){u(i,a,n,o,s,"throw",t)}o(void 0)})}}var s={data:function(){return{items:[],current:0,form:{name:"",image:"",video:"",intro:"",online:1,pType:1,showType:0,category:""},type:"",id:"",confirmBtnName:"确定"}},onLoad:function(e){var r=this;o(n.default.mark(function a(){return n.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return console.log(t(e," at pages\\product\\addProduct\\addProduct.vue:61")),r.type=e.type,r.id=e.id,a.next=5,r.selectCategory();case 5:"modify"===r.type&&(r.confirmBtnName="修改",r.selectDetail());case 6:case"end":return a.stop()}},a,this)}))()},methods:{selectCategory:function(){var e=o(n.default.mark(function e(){var r;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$util.request({requestUrl:"api/category"});case 2:r=e.sent,console.log(t("查询所有类别：",r," at pages\\product\\addProduct\\addProduct.vue:78")),r&&(this.items=r.data.data,0===this.items.length?this.$util.toast("无类别可选，请先去添加类别"):"modify"!==this.type&&(this.current=0,this.form.category=this.items[0].id));case 5:case"end":return e.stop()}},e,this)}));function r(){return e.apply(this,arguments)}return r}(),selectDetail:function(){var e=o(n.default.mark(function e(){var r,a;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$util.request({requestUrl:"api/products/"+this.id});case 2:if(r=e.sent,console.log(t("查询商品详情",r," at pages\\product\\addProduct\\addProduct.vue:96")),!r){e.next=15;break}this.form=r.data.data[0],a=0;case 7:if(!(a<this.items.length)){e.next=15;break}if(this.items[a].id!==this.form.category){e.next=12;break}return this.current=a,this.form.category=this.items[a].id,e.abrupt("break",15);case 12:a++,e.next=7;break;case 15:case"end":return e.stop()}},e,this)}));function r(){return e.apply(this,arguments)}return r}(),uploadVideo:function(){var t="",e=this;a.chooseVideo({count:1,sourceType:["camera","album"],success:function(r){t=r.tempFilePath,a.uploadFile({url:e.$util.url+"api/upload",filePath:t,fileType:"video",name:"file",success:function(t){e.$util.toast("上传成功"),e.form.video=JSON.parse(t.data).data.url},fail:function(t){e.$util.toast("上传失败")}})}})},uploadImage:function(){var t=o(n.default.mark(function t(){var e,r;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$util.selectImage();case 2:return e=t.sent,t.next=5,this.$util.uploadImage(e);case 5:r=t.sent,this.form.image=r;case 7:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),cpimgOk:function(){var e=o(n.default.mark(function e(r){var a;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t(r," at pages\\product\\addProduct\\addProduct.vue:144")),e.next=3,this.$util.uploadImage(r[0]);case 3:a=e.sent,this.form.image=a;case 5:case"end":return e.stop()}},e,this)}));function r(t){return e.apply(this,arguments)}return r}(),confirm:function(){var e=o(n.default.mark(function e(){var r,i;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.form.category){e.next=3;break}return this.$util.toast("请选择类别"),e.abrupt("return");case 3:if(""!==this.form.name){e.next=6;break}return this.$util.toast("请输入名称"),e.abrupt("return");case 6:if(""!==this.form.intro){e.next=9;break}return this.$util.toast("请输入描述"),e.abrupt("return");case 9:if(""!==this.form.image){e.next=12;break}return this.$util.toast("请上传图片"),e.abrupt("return");case 12:if(1!==this.form.showType||""!==this.form.video){e.next=15;break}return this.$util.toast("请上传视频"),e.abrupt("return");case 15:if(console.log(t(this.form," at pages\\product\\addProduct\\addProduct.vue:173")),"modify"!==this.type){e.next=24;break}return e.next=19,this.$util.request({requestUrl:"api/products/"+this.id,method:"PUT",data:this.form});case 19:r=e.sent,console.log(t("修改商品信息",r," at pages\\product\\addProduct\\addProduct.vue:181")),r&&(this.$util.toast("修改成功"),setTimeout(function(){a.navigateBack()},500)),e.next=29;break;case 24:return e.next=26,this.$util.request({requestUrl:"api/products",method:"POST",data:this.form});case 26:i=e.sent,console.log(t("添加商品",i," at pages\\product\\addProduct\\addProduct.vue:194")),i&&(this.$util.toast("添加成功"),this.current=0,this.form={name:"",image:"",video:"",intro:"",online:1,pType:1,showType:0,category:this.items[0].id,type:"",id:""});case 29:case"end":return e.stop()}},e,this)}));function r(){return e.apply(this,arguments)}return r}(),radioChange:function(t){for(var e=0;e<this.items.length;e++)if(this.items[e].id===t.target.value){this.current=e,this.form.category=this.items[e].id;break}},switch1Change:function(t){t.target.value?this.form.online=1:this.form.online=0},switch2Change:function(t){t.target.value?this.form.pType=1:this.form.pType=0},switch3Change:function(t){t.target.value?this.form.showType=1:(this.form.showType=0,this.form.video="")}}};e.default=s}).call(this,r("0de9")["default"],r("6e42")["default"])},bff4:function(t,e,r){"use strict";r.r(e);var a=r("3508"),n=r("d734");for(var i in n)"default"!==i&&function(t){r.d(e,t,function(){return n[t]})}(i);var u=r("2877"),o=Object(u["a"])(n["default"],a["a"],a["b"],!1,null,null,null);e["default"]=o.exports},d734:function(t,e,r){"use strict";r.r(e);var a=r("9647"),n=r.n(a);for(var i in a)"default"!==i&&function(t){r.d(e,t,function(){return a[t]})}(i);e["default"]=n.a},e4c4:function(t,e,r){"use strict";(function(t){r("31b3"),r("921b");a(r("66fd"));var e=a(r("bff4"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,r("6e42")["createPage"])}},[["e4c4","common/runtime","common/vendor"]]]);